<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>My Line Chart</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.js"></script>
    <script src="https://chartjs-plugin-datalabels.netlify.com/chartjs-plugin-datalabels.js"></script>
    <style>
      canvas {
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
        display: block; height: 534px; width: 1068px;
      }
    </style>
  </head>

  <body>
    <div style="width:75%">
      <h1> prototyping chart </h1>
      <canvas id="canvas" width="1024" height="300"></canvas>
      <img src="wireframe.jpg" alt="wireframe" width="1024">
    </div>
    <script>

      let rawData = [
        {index:1, temperature:35.5, label: 'Day 0\n18:00'},
        {index:2, temperature:36, label: 'Day 0\n20:00'},
        {index:3, temperature:36.4, label: 'Day 1\n02:00'},
        {index:4, temperature:36.9, label: 'Day 1\n18:00'},
        {index:5, temperature:37.1, label: 'Day 2\n07:30'},
        {index:6, temperature:38, label: 'Day 2\n07:45'},
        {index:7, temperature:39.4, label: 'Day 2\n08:05'},
      ]
      function createDateData() {
        return rawData.map( r => {
          return {x: r.index, y:1, label: r.label}
        })
      }
      var upTick = new Image(20,20)
      // yourImage.src ='http://your.site.com/your_image.png';
      upTick.src ='http://localhost:28000/vital/upTick.png';
      var imageData = {
        labels: ['Day 0', 'two', 'three', 'four'],
        datasets: [{
          label: 'dates',
          // set point sizes, doesn't work on images
          pointRadius: [10, 0, 10, 5],
          pointHoverRadius: 20,
          pointHitRadius: 20,
          pointStyle: ['rect', upTick, 'triangle', 'circle'],
          // demonstrates that non-image points can be rotated
          pointRotation: [30,34,55,0],
          // color of the points that are not from images
          pointBackgroundColor: "rgba(0,191,255)",
          // set a background color so data labels have area that obscures the grid lines
          backgroundColor: "rgba(255,255,255)",
          data: [
            {x:1, y:1, label: 'Day 0\n18:00'},
            {x:2, y:1, label: 'Day 0\n20:00'},
            {x:3, y:1, label: 'Day 1\n02:00'},
            {x:4, y:1, label: 'Day 1\n18:00'},
            ]
        }]
      }

      var commonData = {
        labels: ['Day 0', 'two', 'three', 'four'],
        datasets: [{
          label: 'dates',
          // set point sizes, doesn't work on images
          pointRadius: [10, 0, 10, 5],
          pointHoverRadius: 20,
          pointHitRadius: 20,
          pointStyle: ['rect', upTick, 'triangle', 'circle'],
          // demonstrates that non-image points can be rotated
          pointRotation: [30,34,55,0],
          // color of the points that are not from images
          pointBackgroundColor: "rgba(0,191,255)",
          // set a background color so data labels have area that obscures the grid lines
          backgroundColor: "rgba(255,255,255)",
          data: [
            {x:1, y:1, label: 'Day 0\n18:00'},
            {x:2, y:1, label: 'Day 0\n20:00'},
            {x:3, y:1, label: 'Day 1\n02:00'},
            {x:4, y:1, label: 'Day 1\n18:00'},
          ]
        }]
      }
      var dateData = {
        datasets: [{
          label: 'dates',
          // set point sizes, doesn't work on images
          pointRadius: 0,
          pointHoverRadius: 0,
          pointHitRadius: 0,
          // pointStyle: ['rect', upTick, 'triangle', 'circle'],
          // demonstrates that non-image points can be rotated
          // pointRotation: [30,34,55,0],
          // color of the points that are not from images
          pointBackgroundColor: "rgba(0,191,255)",
          // set a background color so data labels have area that obscures the grid lines
          backgroundColor: "rgba(255,255,255)",
          data: createDateData()
        }]
      }

      var commonOptions = {
        // TODO do we need responsive and maintainAspectRatio?
        responsive: true,
        maintainAspectRatio: true,
        legend: {
          // do not display legend at top of canvas
          display:false
        },
        scales: {
          yAxes: [{
            gridLines: {
              color: "rgba(0,0,0, 0.5)"
            },
          }],
          xAxes: [{
            gridLines: {
              color: "rgba(0,0,100, 0.5)"
            },
          }]
        },
        tooltips: { // copied this from someplace ... need to explore what tool tips options are good to have
          mode: 'index',
          intersect: false
        }
      };
      var datesOptions = {
        scales: {
          yAxes: [{
            ticks: {
              // can customize the y-axis tick label font
              fontColor: "#291F3e",
              min: 1, // minimum will be 1, unless there is a lower value.
              max: 1,
              callback: function(value, index, values) {
                return null
              }
            }
          }],
          xAxes: [{
            scaleLabel: {
              display: true,
              labelString: '1k = 1000'
            },
            ticks: {
              min: 0,
              suggestedMax: 5,
              callback: function(value, index, values) {
                if (value % 1 === 0 )
                  return null; // don't show these grid lines
                return ''; // hide the x axis label
              }
            }
          }]
        },
        plugins: {
          datalabels: {
            align: 'end',
            anchor: 'end',
            // use the dataset background color in case it has been customized
            backgroundColor: function(context) {
              return context.dataset.backgroundColor;
            },
            //
            borderRadius: 4,
            color: 'black',
            font: {
              size: "20"
            },
            formatter: function(value){
              console.log('formatter', value)
              return value.label;
            }
          }
        }
      };
      var tempuratureOptions = {
        scales: {
          yAxes: [{
            scaleLabel: {
              display: true,
              labelString: '1k = 1000'
            },
            ticks: {
              // can customize the y-axis tick label font
              fontColor: "#291F3e",
              suggestedMin: 1, // minimum will be 1, unless there is a lower value.
              suggestedMax: 1,
              callback: function(value, index, values) {
                return value + '*'; // can modify the label
              }
            }
          }],
          xAxes: [{
            scaleLabel: {
              display: true,
              labelString: '1k = 1000'
            },
            ticks: {
              min: 0,
              suggestedMax: 5,
              callback: function(value, index, values) {
                if (value % 1 === 0 )
                  return null; // don't show these grid lines
                return ''; // hide the x axis label
              }
            }
          }]
        },
        plugins: {
          datalabels: {
            align: 'end',
            anchor: 'end',
            // use the dataset background color in case it has been customized
            backgroundColor: function(context) {
              return context.dataset.backgroundColor;
            },
            //
            borderRadius: 4,
            color: 'black',
            formatter: function(value){
              console.log('formatter', value)
              return value.label;
            }
          }
        }
      };

      window.onload = function() {
        var lineID = document.getElementById('canvas').getContext('2d');
        var lineChart = new Chart(lineID, {
          type: 'scatter',
          data: dateData,
          options: Object.assign(commonOptions, datesOptions)
        });
      }

    </script>
  </body>
</html>
